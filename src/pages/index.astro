---
import TagFilter from "./components/TagFilter.jsx";
import "starlight-site-graph/styles/variables.css";
import "../styles/global.css";
import { PageGraph } from "starlight-site-graph/components";
import Navbar from "./components/Navbar";
const posts = await Astro.glob("../pages/**/*.md");
posts.sort(
  (a, b) =>
    new Date(b.frontmatter.date).getTime() -
    new Date(a.frontmatter.date).getTime()
);

//tags
let uniqueTags = Array.from(
  new Set(posts.flatMap((p) => p.frontmatter.tags || []))
);
---

<html lang="de">
  <head>
    <title>Mein Blog</title>
  </head>
  <body class="bg-gray-50 text-gray-800 font-sans p-8">
    <Navbar client:load />
    <div style="height: 50px;"></div>

    <h1 class="text-4xl font-bold mb-6">Alle Posts</h1>
    <ul class="space-y-4">
      {
        posts.map((post) => (
          <li class="p-4 bg-white rounded-lg shadow hover:shadow-md transition">
            <a
              href={post.url}
              class="text-blue-600 hover:text-blue-800 font-medium"
            >
              {post.frontmatter.title}
            </a>
            <br />
            <small class="text-gray-500">{post.frontmatter.date}</small>
          </li>
        ))
      }
    </ul>

    <h2 class="text-2xl font-semibold mt-10 mb-4">Tags</h2>
    <TagFilter client:load posts={posts} />
    <div class="mt-10">
      <PageGraph />
    </div>
  </body>
</html>
